# Документация проекта

# Описание

Сервис предоставляет инструменты для загрузки DICOM файлов и последующей разметки изображений из этих файлов. Размеченные изображения хранятся на сервере, и могут быть использованы впоследствии для обучения ML моделей. Сервер предоставляет минималичтичный REST API для поиска рамеченных медицинских изображений по заданным параметрам. Наприме, пользователь может найти все изображения с определенными тегами или модальностями. Такой инструмент может быть очень полезен всем исследователям и ML-специалистам, которым нужны датасеты для обучения.

# Адрес сервера

`http://45.135.165.211:8181`

OpenAPI спецификация API: 

- `http://45.135.165.211:8181/api-docs`
- `http://45.135.165.211:8181/api-ui.html`

## API разметки

### Загрузка DICOM файла

*Метод*: `POST`

*Путь*: `/dicom`

| Parameter | Description |
| :----------- | :--------------- |
| file | DICOM файл в формате Multipart файл |

Ответ:


```json
{
    "dicomId": "Integer"
}
```

### Данные DICOM

Запрос возвращает поля из DICOM файла с указанным идентификатором. Медиа не возвращается. Вместо медиа возвращаются идентификаторы, используя которые можно получить данные отдельными запросами.

*Метод*: `GET`

*Путь*: `/dicom/{dicomId}/fields`

Параметры:

| Parameter | Description |
| :----------- | :--------------- |
| dicomId | Идентификатор файла|

Ответ:

```json
{
    "dicomId": "Integer",
    "imagesNumber": "Integer",
    "modality": "String"
}
```

### Изображение

Запрос возвращает из DICOM файла с идентификатором {dicomId} изображение с идентификатором {imageId}

*Метод*: `GET`

*Путь*: `/dicom/{dicomId}/image/{imageId}`

| Parameter | Description |
| :----------- | :--------------- |
| dicomId | Идентификатор файла |
| imageId | Идентификатор изображения |

Ответ: изображение

### Получение разметки для изображения

Запрос возвращает набор примитивов разметки для изображения {imageId} DICOM файла {dicomId}

*Метод*: `GET`

*Путь*:  `/dicom/{dicomId}/image/{imageId}/markup`

| Parameter | Description |
| :----------- | :--------------- |
| dicomId | инедтификатор файла |
| imageId | Идентификатор изображения |

Ответ:

```json
{
  "dicomId": "Integer",
  "imageId": "Integer",
  "tags": ["String"],
  "markup": [
    {
      "type": "String",
      "geometry": [
        {
          "x": "Float",
          "y": "Float"
        }
      ]
    }
  ]
}
```

### Сохранение разметки для изображения

Запрос сохранения разметки для изображения из DICOM файла 

*Метод*: `POST`

*Путь*:  `/dicom/{dicomId}/image/{imageId}/markup`

| Parameter | Description |
| :----------- | :--------------- |
| dicomId | инедтификатор файла |
| imageId | Идентификатор изображения |
| tags | Список тегов |
| type | Тип примитива |
| geometry | Список точек примитива |

Тело запроса:

```json
{
  "tags": ["String"],
  "markup": [
    {
      "type": "String",
      "geometry": [
        {
          "x": "Float",
          "y": "Float"
        }
      ]
    }
  ]
}
```

Ответ:

```json
{
  "dicomId": "Integer",
  "imageId": "Integer",
  "tags": ["String"],
  "markup": [
    {
      "type": "String",
      "geometry": [
        {
          "x": "Float",
          "y": "Float"
        }
      ]
    }
  ]
}
```

## API поиска

### Список доступных тегов и модальностей

Запрос возвращает список доступных для поиска тегов и модальностей. 

*Метод*: `GET`

*Путь*:  `/search/options`

Ответ:

```json
{
  "tags": ["String"],
  "modalities": ["String"]
}
```

### Поиск размеченных изображений по тегам и модальностям

Запрос выполняет поиск размеченных изображений по спискам указанных тегов и модальностей. Будет возвращен список dicomId и imageId для разметок, подходящмх под указанные параметры.

*Метод*: `POST`

*Путь*:  `/search/markup`

| Parameter | Description |
| :----------- | :--------------- |
| tags | Список тегов разделенных символом `,` |
| modalities | Список модальностей разделенных символом `,` |

Ответ:

```json
{
  "tags": ["String"],
  "markup": [
    {
      "dicomId":"Integer",
      "imageId":"Integer"
     }
    ]
}
```
